#!/bin/bash

echo "ğŸ”„ Y.js WebSocket ì„œë²„ ì¬ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸"
echo "====================================="

YJS_SERVER_IP="43.201.125.200"
YJS_PORT="1234"

echo "ğŸ“‹ Y.js ì„œë²„ ì •ë³´:"
echo "   IP: $YJS_SERVER_IP (Elastic IP)"
echo "   í¬íŠ¸: $YJS_PORT"
echo ""

echo "ğŸ” í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Y.js í”„ë¡œì„¸ìŠ¤ í™•ì¸..."
echo "ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ Y.js ì„œë²„ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”:"
echo ""
echo "# SSHë¡œ Y.js ì„œë²„ ì ‘ì†"
echo "ssh -i your-key.pem ubuntu@$YJS_SERVER_IP"
echo ""
echo "# í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸"
echo "ps aux | grep yjs"
echo "netstat -tlnp | grep :$YJS_PORT"
echo ""
echo "# Y.js ì„œë²„ ì¬ì‹œì‘ (PM2 ì‚¬ìš©í•˜ëŠ” ê²½ìš°)"
echo "pm2 restart yjs-server"
echo "pm2 status"
echo ""
echo "# Y.js ì„œë²„ ì¬ì‹œì‘ (ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ê²½ìš°)"
echo "pkill -f yjs-server"
echo "cd /path/to/yjs-server"
echo "nohup node yjs-server.js > yjs.log 2>&1 &"
echo ""
echo "# ì„œë¹„ìŠ¤ë¡œ ì‹¤í–‰í•˜ëŠ” ê²½ìš°"
echo "sudo systemctl restart yjs-server"
echo "sudo systemctl status yjs-server"
echo ""
echo "# í¬íŠ¸ í™•ì¸"
echo "netstat -tlnp | grep :$YJS_PORT"
echo ""
echo "ğŸŒ í…ŒìŠ¤íŠ¸ URL:"
echo "   WebSocket: ws://$YJS_SERVER_IP:$YJS_PORT"
echo "   Health Check: http://$YJS_SERVER_IP:$YJS_PORT/health"
echo ""
echo "ğŸ“ í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì • í™•ì¸:"
echo "   config.js: YJS_WEBSOCKET_URL = 'ws://$YJS_SERVER_IP:$YJS_PORT'"
echo "   NoCodeEditor.jsx: wsUrl=\"ws://$YJS_SERVER_IP:$YJS_PORT\""
